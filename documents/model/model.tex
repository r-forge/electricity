\section{The model}


In order to investigate investment decisions, we set up a realistic model which combines an oligopolistic market, different market states, different technologies to invest in, and a two stage investment game. The uncertainty about future demand is accounted for by different demand scenarios. The stochastic programming, game with probabilistic scenarios (GPS) approach in \cite{Genc2007} makes it possible to compute $S$-adapted equilibra for much larger problems than is possible using dynamic programming.

\begin{gather}
	\max_{q_{i,k}^{s,m,t}} \pi_i=  \sum_{s\in S} p_s \sum_{t\in T} \epsilon \sum_{m\in M} \nu_{m\in M} \times \\ \nonumber 
	\left[\left(\alpha-\beta\left(\sum_{i\in N} \sum_{k\in K} q_{i,k}^{s,m,t}+\sum_{k\in K}q_{i,k}^{s,m,t}\right)\right) \sum_{k\in K} q_{i,k}^{s,m,t} - \sum_{k\in K}c^k q_{i,k}^{s,m,t} \right] \\ \nonumber 
	- \sum_{k\in K}\Gamma_k \times I_{i,k} + \sum_{k\in K} F_k \\ \nonumber
	\text{s.t.:} \  q_{i,k}^{s,m,t}-K_{i,k}^t \leq 0; \\  \nonumber
											K^{t+1}_{i,k} - \rho K_{i,k}^t - I_{i,k} = 0 \\ \nonumber
 										  q_i^k, I_{i,k}, K_{i,k}^t	\geq 0  \nonumber
	\end{gather}
	
\begin{longtable}[c]{l l}
$i\in N$                           	& players, firms\\
$s\in S$       											& scenarios\\
$m\in M$													 	& states of the market \\
$k\in K$													 	& technologies \\
$t\in T$													 	& time \\
$K_{i,k}^t$                         & available capacity at time $t$ from technology $k$ for firm $i$ \\
$q_{i,k}^{s,m,t}$										& quantity at time $t$, technology $k$, firm $i$, in market state $m$ and scenario $s$ \\			
$I_{i,k}^t$                         & investment in technology $k$, at time $t$ from for firm $i$\\
$p_s$                             	& probability of scenario $s$\\
$\nu_m $												  	& says how often (how many hours) market state $m$ occurs \\
$\epsilon $													& discount factor \\
$\alpha(m)$													& demand function intercept in market state $m$ \\
$\beta(m)$													& demand function slope in market state $m$ \\
$c_k$																& variable costs of technology $k$	\\
$\Gamma_k$													& investment costs in technology $k$  \\
$F_k$																& scrap values  \\
\end{longtable}

Each player ($i$) maximizes it´s profit by setting $q_{i,k}^{s,m,t}$ and $I_{i,k}^t$ . By considering different demand developments and the associated probabilities ($p_s$), the players take into account how demand might evolve in the future. Quantities are allowed to be different in different scenarios that evolve, thereby stating that firms can always react to demand by adjusting the short run production. On the contrary, Investments ($I$) are not allowed to differ in such a way as they have to be set in advance when it is not clear jet how high demand might be. Please note that quantities do not depend on what other players might invest they do depend however, on how high own investments are.
% as the cost function can be changed between period one and two($C^1_i vs. C^2_i$). (Idee - Wenn man das weggibt, müsste man den Effekt den eigene Investments auf den Marktpreis haben sehen). 
If, in the solution, quantities would depend on Investments of other players as well, we would enter the realm of feedback or closed loop games (which are the same in the case of a two stage game). It has to be noted here that the solution of a closed loop game can, and will, in general, be different from the solotion of an open loop game.

To solve the model, we derive tha Karush Kuhn Tucker Conditions (KKT) to obtaion a mixed complementarity Problem which we solve by using GAMS and the PATH solver. For the model above, we used the Cournot approach to derive the first order conditions. For the competitive benchmark we skipped the index $i$ and solved the problem under the assumption that just one player disposes of all the initial capacities of the four players. When deriving the KKT conditions, this player is assumed to set prices equal to marginal costs.

%\clearpage

\section{Results} 

First, we consider a version of the model with two stages and two possible future demand states which are accounted for by a binomial tree structure. For the discount factor, we assume an interest rate of 5 \% and thereby assume that this figure is the same for all players. Equivalently, we set the depreciation rate to 2,5 \% a year. As we have two periods, and each is assumed to last for two years, this version of the model represents a medium term perspective. \\
In Table \ref{tab:quant}, quantities and market prices for time period one and the high demand state are shown. It can be seen that during the high demand state, all capacities are fully utilized.

\begin{table}[htb]
\centering
\caption{Equilibrium quantities at $t=0$ (high market state)}
\vspace{0.3cm}
% Table generated by Excel2LaTeX from sheet 'Tabelle1'
% Table generated by Excel2LaTeX from sheet 'Tabelle1'
\begin{tabular}{rrrrr}
\hline
           &        RWE &        EON & Vattenfall &       EnBW \\
\hline
     Hydro &        726 &       1304 &          9 &        438 \\

   Nuclear &       5478 &       8452 &       1412 &       4263 \\

     BCoal &      10531 &       1409 &       6923 &        444 \\

     HCoal &       7227 &       9439 &       1720 &       3279 \\

       Gas &       4277 &       3789 &        860 &       1074 \\

       Oil &        175 &       1763 &       1418 &        608 \\

      Pump &        778 &       1095 &       2870 &        358 \\
\hline
\end{tabular}  
\label{tab:quant}
\\
\vspace{0.3cm}
\scriptsize Source: own calculations
\end{table}

Table \ref{tab:lambda} shows the shadow price of capacity for each of the firms. It can be seen here, that the value of an additional unit of capacity is very different for different oligopolistic players. Actually it only takes on positive values for Vattenfall and EnBW during high and extremly high market states. For most of the players, additional capacity is of no value, even in high demand states. This is intuitive however, as an additional unit of capacity might be not worth it for a big player because it lowers the price he gets for all the other units sold. For small players like Vattenfall and EnbW an additional unit of capacity is valuable, at least in high market states.

\begin{table}[htb]
\centering
\caption{Shadow prices of an additional unit of capacity}
\vspace{0.3cm}
% Table generated by Excel2LaTeX from sheet 'Tabelle1'
% Table generated by Excel2LaTeX from sheet 'Tabelle1'
\begin{tabular}{lrrrr}
\hline
           & Vattenfall &            &       EnBW &            \\
\hline
           &    exthigh &      vhigh &    exthigh &      vhigh \\
\hline
     Hydro &     11.567 &          0 &     47.838 &     18.649 \\

   Nuclear &      9.601 &          0 &     45.886 &     16.365 \\

     BCoal &      8.479 &          0 &     44.838 &     15.648 \\

     HCoal &      2.996 &          0 &     39.289 &      9.811 \\

       Gas &          0 &          0 &     21.911 &          0 \\

       Oil &          0 &          0 &     11.429 &          0 \\

      Pump &          0 &          0 &          0 &          0 \\
\hline
\end{tabular}  
\label{tab:lambda}
\\
\vspace{0.3cm}
\scriptsize Source: own calculations
\end{table}

Having looked at the shadow prices it is now not surprising that EnBW and Vattanfall are the only two players which will invest. In Table \ref{tab:invest} the investment levels are given and are contrasted with the amounts of investments, a perfectly competitive market would yield. Apparently, there seems to be a distortion towards too low investments in the oligopoly case. It is also of interest, that a social planner would not invest in gas fired plants, suggesting that not only the level of investments, but also the technology mix used to satisfy the varying demands might be different in an oligopolistic market, than under perfect competition.

\begin{table}[htb]
\centering
\caption{Investments in different market forms}
\vspace{0.3cm}
% Table generated by Excel2LaTeX from sheet 'Tabelle1'
\begin{tabular}{llrrrr}
\hline
           &            &    Nuclear &      BCoal &      HCoal &        Gas \\

\hline
 oligopoly &     Vatten &         13 &         91 &         48 &          2 \\

           &       EnBW &        329 &        399 &        319 &        150 \\

\hline
 perfect comp. benchmark &            &        744 &       1387 &        910 &            \\
\hline
\end{tabular}  
\label{tab:lambda}
\\
\vspace{0.3cm}
\scriptsize Source: own calculations
\end{table}

\section{Conclusions}

In this paper, we investigate inhowfar deregulated electricity markets can be expected to deliver optimal investments into plants. A purely analytical model cannot answer this question, as, from the analytical side, it is unclear whether the combination of a peak load pricing problem, an oligopolistic market structure and uncertainty will create under- or even overinvestment. The German electricity market provided us with a real world example for our numerical model. Building on \cite{Genc2007} we extend their framework further toward a more realistic representation of market states and technologies and develop a normative welfare-optimal benchmark. We came to the preliminary conclusion that there seems to be an underinvestment problem arising from the current market framework. Additionally, it seems as if also the chosen technology mix is distorted away from what is optimal. 

Further research will focus on a model which allows more conclusions about the long run development of capacities. Additionally, the use of different information structures would be interesting.



%\subsection{Notation}

%\begin{longtable}[c]{l l}
%$i\in N=\left\{ 1,2,\dots,n\right\}$                           & players, firms\\
%$s\in S=\left\{ 1,2,\dots,\omega\right\}, \omega<\infty$       & scenarios je nachdem ob recursive oder non - recursive werden auch Nodes gebraucht\\
%$p_s$                                                          & probability of scenario $s$\\
%$h\in H \left\{ 1,2,\dots,O\right\}$													 & states of the market \\
%$u_h$																														 & scalar that says how often (how many hours) market state $h$ occurs \\
%$k\in K=\left\{ 1,2,\dots,m\right\}$                           & available technologies \\
%$K_{i,k}^t$                                                     & available capacity at time $t$ from technology $k$ for firm $i$\\
%$K_i^{t,s}=\left[K_{i,1}^{t,s},K_{i,2}^{t,s},\dots,K_{i,m}^{t,s}\right]$                                    & total available capacity at time $t$ for firm $i$\\

%$q_{i}^{t,s}=\left[q_{i,1}^{t,s}, q_{i,1}^{t,s}, \dots, q_{i,m}^{t,s}\right]$                                                     & quantity\\
%$Q(K_t)=\sum_{i=1}^nq_i$                                        & total produced quantity of all firms\\
%$P(Q)$                                                          & inverse demand function\\
%$P_h(Q)= \alpha_h - \beta_h \sum_{i=1}^n g_i$										& Different inverse demand functions depending on market states \\
%$I_{i,s}^{t,m}$                                                 & investment quantities in technology $m$ at time $t$, scenario $s$ and by player $i$\\
%$c_m$																														& variable costs of technology $m$	\\
%$ic_m$																													& investment costs in technology $m$  \\
%$\Pi_i=\sum_{s=1}^\omega p_s\Pi_{i,s}$                          & total expected profit for player $i$\\

%\end{longtable}

%Profit Function:

%Profit for each player $i$ in every period consists of the sum of profits made during different market states minus investments $I_{i,s}^{t,m}$ that are made at that point in time in that scenario.

%\begin{gather}
%	\Pi^t_{i,s} = \sum_{h=1}^O u_h \left[  (\alpha_h - \beta_h \sum_{i=1}^n q_i^{t,s,h}) q_i^{t,s,h} - \sum_{k=1}^{m} (q^{t,s,h}_{i,m} c_m + \frac{1}{(K^{t,s}_{i,m}-q^{t,s,h}_{i,m})}) \right] - \sum_{k=1}^{m} I_{i,s}^{t,m}  ic_m \\
%\text{s.t.:} \  	q^{t,s,h}_{i,m} \leq K^{t,s}_{i,m}, \forall t,s,k,i,m \\
%             \    q^{t,s,h}_{i,m} \geq 0; K^{t,s}_{i,m} \geq 0 \\
%\end{gather}

%A two stage game:

%\begin{gather}
%	\Pi_{i} = \sum_{h=1}^5 u_h \left[ P^1(Q) q^{1,k}_i-C^1_i(q^{1,k}_i) \right] - \sum_{k=1}^{m} I_{i}^{1,m}  ic_m +  \\
%	\sum_{s=1}^2 p_s \left[ \sum_{h=1}^5 u_h \left[ P^s(Q) q_i^{2,s,h}- C^2_i(q_i^{2,s,h}) \right] \right] \\
%\text{s.t.:} \  	q^{1,k}_{i,m} \leq K^1_{i,m} \\
%									K^2_{i,m}= K^1_{i,m}+ I^1_{i,m} \\
%									q_i^{2,s,h} \leq K^2_{i,m} \\
%             \    q^{1,k}_{i,m} \geq 0;q_i^{2,s,h} \geq 0; K^2_{i,m} \geq 0  \\               
%\end{gather}

%An example of a two stage formulation ($t={1,2}$) for five market states ($O=5$) and two possible demand scenarios in period 2. Player $i$ maximizes it´s profit by setting $q$ and $I$. By considering different demand states and the associated probabilities, he takes into account how demand might evolve. So $q^2$ is different, depending on the demand state in which you are in($q^2(\xi)$). $I$ is not allowed to differ in such a way as it has to be set in advance when it is not clear how high demand might be. Please note that $q^2$ does not depend on what other players might invest it does depend however, on how high own investments are as the cost function can be changed between period one and two($C^1_i vs. C^2_i$). (Idee - Wenn man das weggibt, müsste man den Effekt den eigene Investments auf den Marktpreis haben sehen). If, in the solution, $q^2$ would depend on Investments of others as well ($q^2(\xi,I)$), we would enter the realm of feedback or closed loop games (which are the same in the case of a two stage game). Other possible values of $q^2$ would, of course also result in other values of investments in the first stage and so the solution to a closed loop game will, in general, differ from open loop games.   \\ 

%\subsection{An Example of a Closed Loop Game (just for curiosity)}

%In a two stage - closed loop formulation a firm would not only consider how uncertainty might materialize in the future, but it would also consider what the other firms might do. A firm might ask itself ok if i invest into a coal plant and a nuclear plant and the other guys invest into a gas plant each, how will my profits look like after I solved my oligopoly model to consider uncertainty? To arrive at such a kind of equilibrium, one has to enumerate all possible combinations of investments that might be pursued. If every firm could invest into three different technologies for example and could buy three plants each at maximum, each firm has 64 different strategies. Combining four players with 64 strategies each, we have $64^4\approx$ sixteen million different equilibria to compute. In all these possible combinations one can then search for Nash Equilibria according to the usual conditions for Nash Equilibria.



%For formulation of cost functions see \cite{Bergman1995}, \cite{Pineau2003}.	
%For existence proof of Nash-Cournot equilibria for oligopolies see \cite{Murphy1982}.

\clearpage

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "../emarket_simulation"
%%% End: 
